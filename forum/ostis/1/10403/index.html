Проблема с подключение своей операции к новой SRS

Сообщение Okne » 10 май 2010, 15:02
Столкнулся с такой проблемой, когда подключаю свою операцию.

Error in file '..\..\src\scp\scp_core.cpp' at line 1258: Program /operation/logic/view_statement/view_statement_ui haven't constants

Error in file '..\..\src\scp\scp_core.cpp' at line 1021: Could not create constsegments set for scp-process
Processes hierarchy from father to son:
File "UNKNOWN", line "UNKNOWN",
File "../fs_repo_src/operation/set_run_scp_handler.m4scp", line 287, call
Error: Error while creating process for program '/operation/logic/view_statement/view_statement_ui'

Собственно операция:

Код: выделить все
    #include "scp_keynodes.scsy"
    #include "ui_keynodes.scsy"

    procedure(view_statement_ui,
    [[
       ui_Output;
       hello = /"Hello"/;
    ]],
    [{
       answer_reciever, window_content
    }],
    {[
       1_: in_: window_content,
       2_: in_: answer_reciever
    ]}
    )

    printEl([ 1_: fixed_: window_content ])

    return()
    end



В scg_menu.scsy прописал:

Код: выделить все
    $менюПросмотрБазыЗнаний11 = {
       list_value_: { caption_: /"Запросы, связанные с логикой высказываний"/, menu_: $ЗапросыПоЛогикеВысказываний, item_: "Запросы, связанные с логикой высказываний" },
       list_next_: $none0
    };

    ////////////////////////////////////////////////////////////////////////
    /// Главное меню/ПросмотрБазыЗнаний/Запросы, связанные с логикой высказываний

    $ЗапросыПоЛогикеВысказываний = {
       list_value_: { caption_: /"Вывод утверждения"/, id_: "Descr_logic_view_statement", item_: {} },
       list_next_: $none0
    };



В event.scsy прописал:

Код: выделить все
    descr_user_cmd = {
       Descr_logic_view_statement = {
          class_: user_smd_view_statement_ui = "view_statement_ui",
          prm_: {
             1_: const_: "/operation/logic/view_statement/view_statement_ui",
             2_: ui_cmd_desc_window_content,
             3_: ui_cmd_desc_answer_reciever
          },
          eventListener_: start_scp_program
       }
    };



программа лежит в fs_repo_src/operation/logic/view_statement.m4scp

программа взята из премера, только переименована, причём сам пример работает
В чём проблема???

Заранее спасибо

Okne


Сообщение LazurkinDA » 10 май 2010, 18:04
Выполните команду "m4.exe m4scp.m4 view_statement_ui.m4scp > out.scs" и покажите содержимое файла out.scs.
m4.exe и m4scp должны лежать где-то рядом с вашим билдером (в папке bin).

LazurkinDA


Сообщение DenisKoronchik » 10 май 2010, 18:08
и что прописано в set_run_scp_handler?

DenisKoronchik


Сообщение Okne » 10 май 2010, 20:38
содержание файла out.scs

Код: выделить все
    //=====================================
    //        Translated from M4SCP     
    //  this file was autogenerated by m4     
    //      offline support:  ALK&IVP     
    //=====================================#include "scp_keynodes.scsy"
    #include "ui_keynodes.scsy"

    programSCP -> view_statement_ui = {
            const_: view_statement_ui_consts = [
       ui_Output;
       hello = /"Hello"/;
    ],
              var_: view_statement_ui_vars = {
       answer_reciever, window_content
    },
              prm_: view_statement_ui_prms = {
       1_: in_: window_content,
       2_: in_: answer_reciever
    }

    };

    printEl -> view_statement_ui_op1 = {
       operator_file_: /"view_statement.m4scp"/, operator_line_: n/18/,
            1_: fixed_: window_content ,
            goto_: view_statement_ui_op2
    };

    return -> view_statement_ui_op2 = {
       operator_file_: /"view_statement.m4scp"/, operator_line_: n/20/
    };
    view_statement_ui -> init_: view_statement_ui_op1,view_statement_ui_op2;



а в set_run_scp_handler прописанно следующее

Код: выделить все
    ...
    "/ui/scg/menu/view_statement_ui",
    ...

Okne


Сообщение LazurkinDA » 10 май 2010, 20:48

    Андрей К. писал(а)://=====================================
    // Translated from M4SCP
    // this file was autogenerated by m4
    // offline support: ALK&IVP
    //=====================================#include "scp_keynodes.scsy"
    #include "ui_keynodes.scsy"



Ошибка в трансляторе. Инклюда попала в комментарий. Исправлю.
Если хотите быстро исправить, то оставьте в начале файла пустую строку.

LazurkinDA


Сообщение Okne » 10 май 2010, 21:01
Всё работает) просто огромнющее спасибо!

Okne
