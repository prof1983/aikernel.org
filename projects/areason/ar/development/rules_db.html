<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
  <meta http-equiv="Content-Language" content="ru">
  <title>ѕравила дл€ Ѕƒ</title>
  <link rel="stylesheet" type="text/css" href="../styles.css">
</head>

<body>
<table cellspacing=0 cellpadding=0 width="100%" border=0>
<tr><td width=100><img src="../img/logo.gif"></td><td>
<font size=2>
<a href="../index.html">Prof.AR</a> &rarr;
<a href="index.html">–азработчикам</a> &rarr;
<a href="rules.html">ѕравила</a> &rarr;
<b>ѕравила дл€ Ѕƒ</b>
</font>
</td></tr></table>
<hr>

<table cellspacing=0 cellpadding=0 width="100%" border=0>
<tr><td valign=top width=100>
<nobr><font size=2>
</font></nobr>

</td><td>

<h1>ѕравила дл€ Ѕƒ</h1>
<p>ќбъекты баз данных</p>

<h2>1. Ќј»ћ≈Ќќ¬јЌ»я “јЅЋ»÷.</h2>
<p>»менование таблиц должно подчин€тьс€ следующим правилам:
<br>»мена таблиц не имеющие родительской таблицы == Ђ—оставное строчное им€ї отражающее содержимое таблицы.
<br>ѕример:
<ul>
  <li>еnterprise (юридические лица);</li>
  <li>сlient ( орреспонденты);</li>
  <li>people (физические лица);</li>
</ul>
</p>
<p>»мена дочерних таблиц == им€ родительской таблицы + им€ дочерней таблицы, разделенные символом подчеркивани€. ѕод Ђдочернейї понимаетс€ така€ таблица, из которой, при удалении записи  в родительской таблице,  удал€ютс€ все записи имеющие ссылку на удал€емую запись в родительской таблице. 
<br>ѕример:
<ul>
  <li>client_account (—чета корреспондентов);</li>
  <li>client_personnel (—отрудники корреспондентов)</li>
</ul>
</p>
<p>»мена дочерних таблиц, имеющих строчную часть, но не имеющих собственного имени, формируютс€ из имени родительской таблицы + постфикс У_rowФ.
<br>ѕример:
<ul>
  <li>credit (ƒокумент Ђ редитыї);</li>
  <li>credit_row (—трочна€ часть документа);</li>
  <li>credit_penalty (ѕени по кредиту);</li>
  <li>credit_percent (ѕроценты по кредиту)</li>
</ul>
</p>

<h2>2. Ќј»ћ≈Ќќ¬јЌ»я ѕќЋ≈… “јЅЋ»÷.</h2>
<p>»менование полей таблицы должно подчин€тьс€ следующим правилам:</p>
<ul>
  <li>Ђ»м€ пол€ простого типаї Ч Ђ—оставное строчное им€ї отражающее содержимое пол€.</li>
  <li>Ђ»м€ пол€ ссылочного типаї == наименование таблицы, на которую ссылаетс€ данное поле + постфикс Ђ_idї. »сключение составл€ют случаи, когда есть несколько ссылок на одну и ту же таблицу. ¬ этом случае им€ пол€ формируетс€ как Ђ»м€ пол€ простого типаї + постфикс Ђ_idї.</li>
  <li>ѕол€ типа Ђtinyintї, принимающие значени€ 1 или 0 == префикс Ђflag_ї + Ђ—оставное строчное им€ї. Ђ—оставное строчное им€ї должно отражать содержимое пол€, при состо€нии флага равному 1.</li>
</ul>
</p>
<p>ѕример:
<ul>
  <li>client_id (ссылка на таблицу корреспондентов);</li>
  <li>tax_client_id, estim_client_id (ссылки на таблицу корреспондентов ЂClientї, налогоплательщик, распор€дитель сметы);</li>
  <li>flag_confirm (флаг 1 = утвержден, 0 = не утвержден);</li>
  <li>comment (комментарий)</li>
  <li>basement (основание)</li>
</ul>
</p>

<p>ѕеречень имен полей дл€ об€зательного использовани€, при совпадении назначени€ полей в таблице.
<ul>
  <li>comment Ч комментарий;</li>
  <li>basement Ч основание;</li>
  <li>ccode Ч символьный код;</li>
  <li>full_code Ч полный код;</li>
  <li>name Ч краткое наименование;</li>
  <li>sname Ч сокращенное наименование (псевдоним);</li>
  <li>fname Ч полное наименование;</li>
  <li>doc_date Ч дата документа;</li>
  <li>doc_num Ч номер документа;</li>
  <li>doc_status Ч состо€ние документа;</li>
  <li>set_date Ч дата утверждени€ документа;</li>
  <li>beg_date Ч дата начала;</li>
  <li>end_date Ч дата конца;</li>
  <li>guid Ч глобальный уникальный идентификатор;</li>
  <li>summa Ч сумма;</li>
  <li>amount Ч количество;</li>
  <li>rate Ч ставка;</li>
  <li>mult Ч коэффициент;</li>
</ul>
</p>
<p>ѕеречень зарезервированных имен.
<ul>
  <li>id;</li>
  <li>owner_id.</li>
</ul>
</p>
<p>Ћюба€ таблица должна иметь первичный ключ Ч автоинкрементное поле с именем Ђidї.
<br>ƒочерн€€ таблица должна иметь поле с именем owner_id, внешним ключом (с ограничением целостности ЂOn Delete = Cascadeї) должна быть св€зана с родительской таблицей (с полем id).
</p>

<h2>3. Ќј»ћ≈Ќќ¬јЌ»я »Ќƒ≈ —ќ¬.</h2>
»менование индексов таблицы должно подчин€тьс€ следующим правилам:
Ђ»м€ индексаї == Ђѕрефик индексаї + Ђ_ї + наименование таблицы + Ђ$ї + пречисление имен полей таблицы, участвующих в построении индекса, разделенных символом У$Ф. 
Ђѕрефик индексаї может принимать одно из следующих значений:
Х	in == обычный индекс;
Х	iu == уникальный индекс.
ѕример: 
Х	iu_credit_penalty$owner_id$doc_num (уникальный индекс в таблице Ђcredit_penaltyї по пол€м Ђowner_idї + Ђdoc_numї)

<h2>4. Ќј»ћ≈Ќќ¬јЌ»я ќ√–јЌ»„≈Ќ»… ÷≈Ћќ—“Ќќ—“».</h2>
»менование ограничени€ целостности таблицы должно подчин€тьс€ следующим правилам:
Ђќграничение целостностиї == Ђѕрефикс ограничени€ целостностиї + Ђ_ї +  наименование таблицы + Ђ$ї + пречисление имен полей таблицы, участвующих в построении индекса, разделенных символом У$Ф.
Ђѕрефикс ограничени€ целостностиї может принимать одно из следующих значений:
Х	pk == PRIMARY KEY
Х	fk == FOREIGN KEY
Х	ck == CHECK 
Х	uk == UNIQUE
Х	dk == DEFAULT 

<h2>5. Ќј»ћ≈Ќќ¬јЌ»я “–»√√≈–ќ¬ “јЅЋ»÷.</h2>
»менование триггера  таблицы должно подчин€тьс€ следующим правилам:
Ђ»м€ триггераї == УtФ +  Ђѕрефикс типа триггераї + Ђ_ї + наименование таблицы.
Ђѕрефикс типа триггераї может иметь длину от двух до четырех символов:
-	ѕервый символ префикса описывает врем€ срабатывани€ триггера и может принимать одно из следующих значений:
Х	a == Ђafterї триггер, срабатывает после обработки SQL-сервером событи€;
Х	b == Ђbeforeї триггер, срабатывает перед обработкой SQL-сервером событи€;
Х	i == Ђinstead ofї триггер, замен€ет собой действи€ SQL-сервера по обработке событи€.
-	¬торой и (дл€ комбинированного триггера) последующие символы Ч это комбинаци€ в алфавитном пор€дке следующих символов:
-	d == Ђdeleteї триггер;
-	i == Ђinsertї триггер;
-	u == Ђupdateї триггер.
–екомендации:
-	¬ыносить избыточную логику из триггеров в хранимые процедуры.
-	Ќе формировать каскады триггеров, подписанных на одно событие.
-	Ќе формировать триггера, функционально аналогичные ограничени€м целостности.
ѕример: 
Х	tai_client (Ђafter-insertї триггер по таблице Ђclientї);
Х	tbu_client (Ђbefore-updateї триггер по таблице Ђclientї);
Х	tadiu_client (Ђafter-delete, insert, updateї триггер по таблице Ђclientї)


<h2>6. Ќј»ћ≈Ќќ¬јЌ»я ‘”Ќ ÷»….</h2>
»менование функции должно подчин€тьс€ следующим правилам: 
Х	Get + Ђ—оставное им€ї + Table Ч дл€ функций, возвращающих таблицы;
Х	Is + Ђ—оставное им€ї Ч дл€ функций, возвращающих 1 или 0;
Х	Get + Ђ—оставное им€ї Ч дл€ функций, возвращающих значени€ остальных типов.
»м€ функции должно отражать назначение функции.
ѕример: 
Х	GetClientCreditSum() (—умма кредита по корреспонденту);
Х	IsClientAccountValid() (ѕроверка счета клиента на закрытие);
Х	GetConfirmedEstimTable() (“аблица ID утвержденных смет);

<h2>7. Ќј»ћ≈Ќќ¬јЌ»я ’–јЌ»ћџ’ ѕ–ќ÷≈ƒ”–.</h2>
»менам хранимых процедур должен предшествовать префикс Ђgsp_ї строчными буквами + Ђ—оставное им€ї, отражающее назначение процедуры. 
ѕример: gsp_CreditRowsSetDocStatus.

<h2>8. Ќј»ћ≈Ќќ¬јЌ»я ѕ–≈ƒ—“ј¬Ћ≈Ќ»….</h2>
»менам представлений должен предшествовать префикс Ђv_ї строчными буквами + Ђ—оставное строчное им€ї, отражающее назначение представлени€. 
ѕример: 
Х	v_sys_object (представление всех системных объектов);
Х	v_used_macro (представление используемых ћакро).

<h2>9. Ќј»ћ≈Ќќ¬јЌ»≈ ѕ≈–≈ћ≈ЌЌџ’</h2>
»м€ переменной €зыка УTransact SQLФ == Ђ»м€ переменнойї, где Ђ“ипизированный префиксї имеет следующие значени€:
Х	@vc 	== varchar
Х	@ch 	== char
Х	@i 	== int, tinyint
Х	@dt	== datetime, smalldatetime
Х	@f 	== float		
Х	@m 	== money
Х	@cur	== cursor
Х	@tbl 	== table

</td></tr></table>

<font size=2>
<hr><a href="mailto:Prof5@mail.ru">E-mail</a>
<br>&copy; <a href="http://prof1983.narod.ru/">Prof</a> 2007
<br>12.03.2007
</font>
</body>
</html>